services:
  web:
    build:
      context: .
      target: prod
    stdin_open: true
    tty: true
    ports:
      - "8080:8080"
    environment:
      - PORT=8080

  # 開発環境
  dev:
    build:
      context: .
      target: dev
    stdin_open: true
    tty: true
    volumes:
      - ./spike-app:/spike-app

  # GCP SDK
  gcloud:
    image: google/cloud-sdk:latest
    stdin_open: true
    tty: true
    working_dir: /spike-app
    volumes:
      - .:/spike-app
      - ./.gcloud-config:/root/.config/gcloud
